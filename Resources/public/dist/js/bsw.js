/*! Anyone */
/*! BackendSteeringWheel4AntD - v0.0.1 - 2019-12-28 */
"use strict";function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}window.bsw=FoundationAntD,window.app=new FoundationAntD({rsaPublicKey:"-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCyhl+6jZ/ENQvs24VpT4+o7Ltc\nB4nFBZ9zYSeVbqYHaXMVpFSZTpAKkgqoy2R9kg7lM6QWnpDcVIPlbE6iqzzJ4Zm5\nIZ18C43C4jhtcNncjY6HRDTykkgul8OX2t6eJrRhRcWFYI7ygoYMZZ7vEfHImsXH\nNydhxUEs0y8aMzWbGwIDAQAB\n-----END PUBLIC KEY-----"},jQuery,Vue,antd),$(function(){app.vue(".app-body").template(app.config.template||null).data(Object.assign({bsw:bsw,timeFormat:"YYYY-MM-DD HH:mm:ss",opposeMap:{yes:"no",no:"yes"},formUrl:null,formMethod:null,spinning:!1,message:null,configure:{},modal:{visible:!1}},app.config.data)).computed(Object.assign({},app.config.computed||{})).method(Object.assign({moment:moment,redirect:function(a){var b=a.location;if(bsw.isMobile()&&this.mobileDefaultCollapsed&&bsw.cookie().set("bsw_menu_collapsed","yes"),b.startsWith("http")||b.startsWith("/"))return location.href=b},getBswData:function(a){return bsw.evalExpr(a.attr("bsw-data"))},redirectByVue:function(a){this.redirect(this.getBswData($(a.item.$el).find("span")))},dispatcherByNative:function(a){var b=this.getBswData($(a)),c=b.function||"console.log";this[c](b,a)},dispatcherByVue:function(a){this.dispatcherByNative($(a.target)[0])},setUrlToForm:function(a,b){this.formUrl=a.location,this.formMethod=$(b).attr("bsw-method")},pagination:function(a,b,c,d){var e=this,f=bsw.parseQueryString(a).uuid;b&&(a=bsw.setParams({page:b},a)),app.request(a).then(function(a){app.response(a).then(function(){e[c]=a.sets.preview.list,e["page_"+f]=b,d&&e[d]()}).catch(function(a){console.warn(a)})}).catch(function(a){console.warn(a)})},filter:function(a,b,c){var d=this,e=this;a.preventDefault(),e[b].validateFields(function(a,b){if(a)return!1;for(var f in b)if(b.hasOwnProperty(f)&&(moment.isMoment(b[f])&&(b[f]=b[f].format(b[f]._f||e[c][f])),bsw.isArray(b[f])))for(var g=0;g<b[f].length;g++)moment.isMoment(b[f][g])&&(b[f][g]=b[f][g].format(b[f][g]._f||e[c][f]));return d[d.formMethod+"FilterForm"](b)})},submitFilterForm:function(a){var b={},c=0;for(var d in a)a.hasOwnProperty(d)&&"undefined"!=typeof a[d]&&null!=a[d]&&0!==a[d].length&&(b[d]=a[d],c+=1);var e=bsw.unsetParamsBeginWith(["filter"]);location.href=bsw.setParams({filter:b},e,!1)},persistence:function(a,b,c){var d=this,e=this;a.preventDefault(),e[b].validateFields(function(a,b){if(a)return!1;for(var f in b)if(b.hasOwnProperty(f)){if(moment.isMoment(b[f])&&(b[f]=b[f].format(b[f]._f||e[c][f])),bsw.isArray(b[f]))for(var g=0;g<b[f].length;g++)moment.isMoment(b[f][g])&&(b[f][g]=b[f][g].format(b[f][g]._f||e[c][f]));bsw.checkJsonDeep(b,f+".fileList")&&delete b[f]}return d[d.formMethod+"PersistenceForm"](b)})},submitPersistenceForm:function(a){var b={submit:a};app.request(this.formUrl,b).then(function(a){app.response(a).catch(function(a){console.warn(a)})}).catch(function(a){console.warn(a)})},uploaderChange:function(a){var b=a.file,c=a.fileList;"done"===b.status?this.spinning=!1:"uploading"===b.status&&(this.spinning=!0);var d=this.keyForFileMd5,e=this.keyForFileSha1,f=this.keyForFileList,g=this.keyForForm;if(!b.response)return void(this[f]=c);b.response.error&&(this[f]=c.slice(0,-1));var h=this[f].slice(-1);if(h.length){var i,j=h[0].response.sets,k=(i={},_defineProperty(i,d,"attachment_md5"),_defineProperty(i,e,"attachment_sha1"),_defineProperty(i,f,"attachment_id"),i);for(var l in k)if(k.hasOwnProperty(l)&&l&&k[l]){var m=""+l.split("_")[0];if(0===$("#"+m).length)continue;this[g].setFieldsValue(_defineProperty({},m,j[k[l]]))}}app.response(b.response).catch(function(a){console.warn(a)})},showModal:function(a){a.visible=!0,this.modal=Object.assign(this.modal,a)},showModalAfterRequest:function(a,b){var c=this;app.request(a.api).then(function(a){app.response(a).then(function(){var b=a.sets,d=b.logic||b;c.showModal({width:d.width||1e3,title:d.title||"Modal page",content:b.content})}).catch(function(a){console.warn(a)})}).catch(function(a){console.warn(a)})},requestByAjax:function(a,b){var c=this;app.request(a.location).then(function(b){app.response(b,function(){c["pagination_refresh_"+a.uuid]()}).catch(function(a){console.warn(a)})}).catch(function(a){console.warn(a)})},showIFrameByVue:function(a){var b=a.target,c=$(b).attr("bsw-url"),d={visible:!0,width:1200,title:"请选择",content:'123<iframe src="'+c+'"></iframe>456'};console.log(d),this.showModal(d)},multipleAction:function(a){console.log(a)}},app.config.method||{})).directive(Object.assign({init:{bind:function(a,b,c){c.context[b.arg]=b.value||b.expression}}},app.config.directive||{})).component(Object.assign({"b-icon":app.d.Icon.createFromIconfontCN({scriptUrl:$("#var-font-symbol").attr("bsw-value")})},app.config.component||{})).init(function(a){$("img.app-captcha").off("click").on("click",function(){var a=$(this).attr("src");a=bsw.setParams({t:bsw.timestamp()},a),$(this).attr("src",a)});var b=100;setTimeout(function(){for(var b in app.config.logic||[])app.config.logic.hasOwnProperty(b)&&app.config.logic[b](a)},b),setTimeout(function(){$(".app-page-loading").fadeOut(200,function(){if("undefined"!=typeof a.message.content){var b=a.message.duration?a.message.duration:void 0;try{app[a.message.classify](a.message.content,b,null,a.message.type)}catch(b){console.warn("Some error happen in source data of message"),console.warn(a.message)}}"undefined"!=typeof a.tips.content&&a.showModal(a.tips)})},b+400)})});