/*! Anyone */
/*! BackendSteeringWheel4AntD - v0.0.1 - 2020-01-09 */
"use strict";function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}window.bsw=FoundationAntD,window.app=new FoundationAntD({rsaPublicKey:"-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCyhl+6jZ/ENQvs24VpT4+o7Ltc\nB4nFBZ9zYSeVbqYHaXMVpFSZTpAKkgqoy2R9kg7lM6QWnpDcVIPlbE6iqzzJ4Zm5\nIZ18C43C4jhtcNncjY6HRDTykkgul8OX2t6eJrRhRcWFYI7ygoYMZZ7vEfHImsXH\nNydhxUEs0y8aMzWbGwIDAQAB\n-----END PUBLIC KEY-----"},jQuery,Vue,antd,window.lang||{}),$(function(){app.vue(".bsw-body").template(app.config.template||null).data(Object.assign({bsw:bsw,timeFormat:"YYYY-MM-DD HH:mm:ss",opposeMap:{yes:"no",no:"yes"},formUrl:null,formMethod:null,theme:"light",themeMap:{dark:"light",light:"dark"},weak:"no",menuWidth:256,menuCollapsed:!1,mobileDefaultCollapsed:!0,ckEditor:{},no_loading_once:!1,spinning:!1,message:null,configure:{},modal:{visible:!1}},app.config.data)).computed(Object.assign({},app.config.computed||{})).method(Object.assign({moment:moment,redirect:function(a){var b=a.location;if(bsw.isMobile()&&this.mobileDefaultCollapsed&&bsw.cookie().set("bsw_menu_collapsed","yes"),b.startsWith("http")||b.startsWith("/"))return location.href=b},getBswData:function(a){return bsw.evalExpr(a.attr("bsw-data"))},redirectByVue:function(a){this.redirect(this.getBswData($(a.item.$el).find("span")))},dispatcher:function(a,b){var c=this,d=function(){var d=a.function||"console.log";c[d](a,b)};"undefined"==typeof a.confirm?d():app.showConfirm(a.confirm,app.lang.confirm_title,{onOk:function(){return d()}})},dispatcherByNative:function(a){this.dispatcher(this.getBswData($(a)),a)},dispatcherByVue:function(a){this.dispatcherByNative($(a.target)[0])},setUrlToForm:function(a,b){this.formUrl=a.location,this.formMethod=$(b).attr("bsw-method")},pagination:function(a,b,c){var d=this;b&&(a=bsw.setParams({page:b},a)),app.request(a).then(function(e){app.response(e).then(function(){d["list_"+c]=e.sets.preview.list,d["page_"+c]=b,d["url_"+c]=a,d["page_data_"+c]=e.sets.preview.page,d["image_change_table_"+c](),history.replaceState({},"",bsw.unsetParams(["uuid"],a))}).catch(function(a){console.warn(a)})}).catch(function(a){console.warn(a)})},filter:function(a,b){var c=this,d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],e=this,f="date_format_"+b;a.preventDefault(),e["form_filter_"+b].validateFields(function(a,g){if(a)return!1;for(var h in g)if(g.hasOwnProperty(h)&&(moment.isMoment(g[h])&&(g[h]=g[h].format(g[h]._f||e[f][h])),bsw.isArray(g[h])))for(var i=0;i<g[h].length;i++)moment.isMoment(g[h][i])&&(g[h][i]=g[h][i].format(g[h][i]._f||e[f][h]));return c[c.formMethod+"FilterForm"](g,b,d)})},submitFilterForm:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d={},e=0;for(var f in a)a.hasOwnProperty(f)&&"undefined"!=typeof a[f]&&null!=a[f]&&0!==a[f].length&&(d[f]=a[f],e+=1);var g=bsw.unsetParamsBeginWith(["filter"]);g=bsw.setParams({filter:d},g),c?location.href=g:this.pagination(g,null,b)},persistence:function(a,b){var c=this,d=this,e="date_format_"+b;a.preventDefault(),d["form_persistence_"+b].validateFields(function(a,f){if(a)return!1;for(var g in f)if(f.hasOwnProperty(g)){if(moment.isMoment(f[g])&&(f[g]=f[g].format(f[g]._f||d[e][g])),bsw.isArray(f[g]))for(var h=0;h<f[g].length;h++)moment.isMoment(f[g][h])&&(f[g][h]=f[g][h].format(f[g][h]._f||d[e][g]));bsw.checkJsonDeep(f,g+".fileList")&&delete f[g]}return c[c.formMethod+"PersistenceForm"](f,b)})},submitPersistenceForm:function(a,b){var c={submit:a};app.request(this.formUrl,c).then(function(a){app.response(a).catch(function(a){console.warn(a)})}).catch(function(a){console.warn(a)})},uploaderChange:function(a){var b=a.file,c=a.fileList;"done"===b.status?this.spinning=!1:"uploading"===b.status&&(this.spinning=!0);var d=this.key_for_file_md5,e=this.key_for_file_sha1,f=this.key_for_file_list;if(!b.response)return void(this[f]=c);b.response.error&&(this[f]=c.slice(0,-1));var g=this[f].slice(-1);if(g.length){var h,i=g[0].response.sets,j=(h={},_defineProperty(h,d,"attachment_md5"),_defineProperty(h,e,"attachment_sha1"),_defineProperty(h,f,"attachment_id"),h);for(var k in j)if(j.hasOwnProperty(k)&&k&&j[k]){var l=""+k.split("_")[0];if(0===$("#"+l).length)continue;this[this.key_for_form].setFieldsValue(_defineProperty({},l,i[j[k]]))}}app.response(b.response).catch(function(a){console.warn(a)})},showModal:function(a){a.visible=!0,"undefined"==typeof a.width&&(a.width=app.popupCosySize().width),this.modal=Object.assign(this.modal,a)},showModalAfterRequest:function(a,b){var c=this;app.request(a.location).then(function(b){app.response(b).then(function(){var d=b.sets,e=d.logic||d;c.showModal({width:e.width||a.width||app.popupCosySize().width,title:e.title||a.title||app.lang.modal_title,content:d.content})}).catch(function(a){console.warn(a)})}).catch(function(a){console.warn(a)})},requestByAjax:function(a,b){var c=this;app.request(a.location).then(function(b){app.response(b,function(){c["pagination_refresh_"+a.uuid]()}).catch(function(a){console.warn(a)})}).catch(function(a){console.warn(a)})},multipleAction:function(a,b){var c=this["selected_row_keys_"+a.uuid];return 0===c.length?app.warning(app.lang.select_item_first):void app.request(a.location,{ids:c}).then(function(a){app.response(a,function(){console.log(a)}).catch(function(a){console.warn(a)})}).catch(function(a){console.warn(a)})},showIFrameByVue:function(a){var b=app.popupCosySize(),c=$(a.target),d=this.getBswData(c);d.location=bsw.setParams({iframe:!0,fill:c.prev().attr("id")},d.location);var e={visible:!0,width:b.width,title:app.lang.please_select,centered:!0,wrapClassName:"bsw-preview-iframe",content:'<iframe id="bsw-preview-iframe" src="'+d.location+'"></iframe>'};this.showModal(e),this.$nextTick(function(){$("#bsw-preview-iframe").height(b.height)})},fillParentForm:function(a,b){return a.ids=this["selected_row_keys_"+a.uuid],0===a.ids.length?app.warning(app.lang.select_item_first):void parent.postMessage(a,"*")},fillParentFormInParent:function(a,b){this.modal.visible=!1,this[this.key_for_form].setFieldsValue(_defineProperty({},a.fill,a.ids.join(",")))},initCkEditor:function(){var a=this;$(".bsw-persistence .bsw-ck-editor").each(function(){var b=$(this).attr("id");ClassicEditor.create(this,{}).then(function(c){a.ckEditor[b]=c,c.plugins.get("FileRepository").createUploadAdapter=function(b){return new FileUploadAdapter(c,b,a.api_upload)},a.ckEditor[b].model.document.on("change:data",function(){a[a.key_for_form].setFieldsValue(_defineProperty({},b,a.ckEditor[b].getData()))})}).catch(function(a){console.log(a.stack)})})}},app.config.method||{})).directive(Object.assign({init:{bind:function(a,b,c){c.context[b.arg]=b.value||b.expression}}},app.config.directive||{})).component(Object.assign({"b-icon":app.d.Icon.createFromIconfontCN({scriptUrl:$("#var-font-symbol").attr("bsw-value")})},app.config.component||{})).init(function(a){$("img.bsw-captcha").off("click").on("click",function(){var a=$(this).attr("src");a=bsw.setParams({t:bsw.timestamp()},a),$(this).attr("src",a)});var b=100;setTimeout(function(){for(var b in app.config.logic||[])app.config.logic.hasOwnProperty(b)&&app.config.logic[b](a)},b),setTimeout(function(){$(".bsw-page-loading").fadeOut(200,function(){if("undefined"!=typeof a.message.content){var b=a.message.duration?a.message.duration:void 0;try{app[a.message.classify](a.message.content,b,null,a.message.type)}catch(b){console.warn(app.lang.message_data_error),console.warn(a.message)}}"undefined"!=typeof a.tips.content&&a.showModal(a.tips)})},b+400)}),window.addEventListener("message",function(a){a.data.function+="InParent",app.cnf.v.dispatcher(a.data,$("body")[0])},!1)});